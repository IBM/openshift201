
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://ibm.github.io/openshift201/exercise-01/readme/">
      
      
        <meta name="author" content="IBM Developer">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-6.1.7">
    
    
      
        <title>Cloudant DB with IBM Cloud Operator - OpenShift 201</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.19753c6b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.196e0c26.min.css">
        
          
          
          <meta name="theme-color" content="#2094f3">
        
      
    
    
    
      
        
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,400,400i,700%7CIBM+Plex+Mono&display=fallback">
        <style>body,input{font-family:"IBM Plex Sans",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"IBM Plex Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
      
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cloudant-db-with-ibm-cloud-operator" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://ibm.github.io/openshift201" title="OpenShift 201" class="md-header-nav__button md-logo" aria-label="OpenShift 201">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            OpenShift 201
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Cloudant DB with IBM Cloud Operator
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/ibm/openshift201/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    openshift201
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          

  

<nav class="md-tabs md-tabs--active" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    <li class="md-tabs__item">
      
      
      <a href="../.." class="md-tabs__link">
        Welcome
      </a>
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
      
        
      
      <a href="./" class="md-tabs__link md-tabs__link--active">
        Workshop
      </a>
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
      
      <a href="../../resources/" class="md-tabs__link">
        References
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://ibm.github.io/openshift201" title="OpenShift 201" class="md-nav__button md-logo" aria-label="OpenShift 201">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    OpenShift 201
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/ibm/openshift201/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    openshift201
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" >
    <label class="md-nav__link" for="nav-1">
      Welcome
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Welcome" data-md-level="1">
      <label class="md-nav__title" for="nav-1">
        <span class="md-nav__icon md-icon"></span>
        Welcome
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../.." class="md-nav__link">
      About the workshop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pre-work/get_started/" class="md-nav__link">
      Create Account and Get Cluster
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pre-work/setup_cli/" class="md-nav__link">
      Configure Shell Access
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    <label class="md-nav__link" for="nav-2">
      Workshop
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="Workshop" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon"></span>
        Workshop
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Cloudant DB with IBM Cloud Operator
        <span class="md-nav__icon md-icon"></span>
      </label>
    
    <a href="./" class="md-nav__link md-nav__link--active">
      Cloudant DB with IBM Cloud Operator
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enable-the-ibm-cloud-operator" class="md-nav__link">
    Enable the IBM Cloud Operator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-cloudant-service-using-the-crds" class="md-nav__link">
    Create a Cloudant Service using the CRDs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-the-nodejs-patient-database-app" class="md-nav__link">
    Deploy the Node.js Patient Database App
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-front-end-patient-health-app-to-use-cloudant-database-backend" class="md-nav__link">
    Configure Front-End Patient Health App to use Cloudant Database Backend
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exercise-02/readme/" class="md-nav__link">
      Configure the Sysdig Agent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exercise-03/readme/" class="md-nav__link">
      Monitor your Cluster with SysDig
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exercise-04/readme/" class="md-nav__link">
      Configure the LogDNA Agent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../exercise-05/readme/" class="md-nav__link">
      Analyze your logs with LogDNA
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" >
    <label class="md-nav__link" for="nav-3">
      References
      <span class="md-nav__icon md-icon"></span>
    </label>
    <nav class="md-nav" aria-label="References" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        <span class="md-nav__icon md-icon"></span>
        References
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../resources/" class="md-nav__link">
      Additional resources
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enable-the-ibm-cloud-operator" class="md-nav__link">
    Enable the IBM Cloud Operator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-a-cloudant-service-using-the-crds" class="md-nav__link">
    Create a Cloudant Service using the CRDs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deploy-the-nodejs-patient-database-app" class="md-nav__link">
    Deploy the Node.js Patient Database App
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configure-front-end-patient-health-app-to-use-cloudant-database-backend" class="md-nav__link">
    Configure Front-End Patient Health App to use Cloudant Database Backend
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ibm/openshift201/edit/master/docs/exercise-01/readme.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="cloudant-db-with-ibm-cloud-operator">Cloudant DB with IBM Cloud Operator<a class="headerlink" href="#cloudant-db-with-ibm-cloud-operator" title="Permanent link">&para;</a></h1>
<p>Currently, the Example Health <code>patient-ui</code> app is using a dummy in-memory patient. In this exercise, you'll create a Cloudant service in IBM Cloud and populate it with patient data. Cloudant is a NoSQL database-as-a-service, based on CouchDB.</p>
<h2 id="enable-the-ibm-cloud-operator">Enable the IBM Cloud Operator<a class="headerlink" href="#enable-the-ibm-cloud-operator" title="Permanent link">&para;</a></h2>
<p>Let's understand exactly how Operators work. In the first exercise, you deployed a simple application using a DeploymentConfig and Pods -- these are "default resources" that come with OpenShift. A custom resource definition allows you to create resources that are not necessarily running within Kubernetes, such an IBM Cloud service. Operators manage the lifecycle of resources and create CRDs, allowing you to manage custom resources the native "Kubernetes" way.</p>
<ol>
<li>Navigate to your OpenShift console, access the <strong>Administrator</strong> view, and click <strong>Operators &gt; OperatorHub</strong></li>
</ol>
<p><img alt="OperatorHub" src="../../assets/operatorhub.png" /></p>
<ol>
<li>Find the <strong>IBM Cloud Operator</strong>, and hit <strong>Install</strong></li>
</ol>
<p><img alt="Operator Install" src="../../assets/cloudoperatorinstall.png" /></p>
<ol>
<li>Keep the default options and hit <strong>Subscribe</strong>:</li>
</ol>
<p><img alt="Operator Subscribe" src="../../assets/operatorsubscribe.png" /></p>
<ol>
<li>You may need to wait a few seconds and refresh for the operator to show up as <code>Installed</code>:</li>
</ol>
<p><img alt="Installed Operators" src="../../assets/installedoperators.png" /></p>
<ol>
<li>Next, you'll need to set your IBM Cloud credentials so that the Operator knows how/where to create your Cloudant service. The operator needs to create the service in your own account, rather than the shared IBM lab account.</li>
</ol>
<div class="highlight"><pre><span></span><code> ibmcloud login --sso
</code></pre></div>
<p>Remember: Pick your own account, <strong>not</strong> IBM.</p>
<div class="highlight"><pre><span></span><code> Select an account:
 <span class="m">1</span>. Sai Vennam<span class="err">&#39;</span>s Account <span class="o">(</span>d815248d6ad0cc354df42d43db45ce09<span class="o">)</span> &lt;-&gt; <span class="m">1909673</span>
 <span class="m">2</span>. IBM <span class="o">(</span>3a4766a7bcab032d4ffc980d360fbf23<span class="o">)</span> &lt;-&gt; <span class="m">338150</span>
 Enter a number&gt; <span class="m">1</span>
</code></pre></div>
<ol>
<li>
<p>Next, set your CF org, space and resource group where the Cloudant service will be created. Resource group is usually named <code>default</code> or <code>Default</code> -- case-sensitive.</p>
<div class="highlight"><pre><span></span><code>ibmcloud target --cf -g Default
or
ibmcloud target --cf -g default
</code></pre></div>
</li>
<li>
<p>Verify that all fields are set:</p>
<div class="highlight"><pre><span></span><code>ibmcloud target
</code></pre></div>
<div class="highlight"><pre><span></span><code>API endpoint:      https://cloud.ibm.com
Region:            us-south
User:              svennam@us.ibm.com
Account:           Sai Vennam<span class="err">&#39;</span>s Account <span class="o">(</span>d815248d6ad0cc354df42d43db45ce09<span class="o">)</span> &lt;-&gt; <span class="m">1909673</span>
Resource group:    default
CF API endpoint:   https://api.us-south.cf.cloud.ibm.com <span class="o">(</span>API version: <span class="m">2</span>.144.0<span class="o">)</span>
Org:               svennam@us.ibm.com
Space:             dev
</code></pre></div>
</li>
</ol>
<p>If any of these fields are not set, the Operator will fail to create your service!</p>
<ol>
<li>
<p>Make sure you're logged in to the cluster in this terminal session. Otherwise you must re-run the command <code>oc login</code> with the cluster information:</p>
<p><a href="../../pre-work/setup_cli/#access-the-openShift-web-console">Access your cluster using the oc CLI</a>.</p>
</li>
<li>
<p>Use the helper script provided by IBM to create a new API token, and register it as a secret in your OpenShift cluster:</p>
<div class="highlight"><pre><span></span><code>curl -sL https://raw.githubusercontent.com/IBM/cloud-operators/master/hack/config-operator.sh <span class="p">|</span> bash
</code></pre></div>
</li>
<li>
<p>Verify that all the fields in <code>data</code> are set for the configmap <span class="arithmatex">\(<code>org</code>, <code>region</code>, <code>resourceGroup</code> and <code>space</code>\)</span> and secret <span class="arithmatex">\(<code>api-key</code> and <code>region</code>\)</span>:</p>
<div class="highlight"><pre><span></span><code>oc get configmap/seed-defaults -o yaml -n default
oc get secret/seed-secret -o yaml -n default
</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre><span></span><code>apiVersion: v1
data:
    org: svennam@us.ibm.com
    region: us-south
    resourceGroup: default
    space: dev
...

apiVersion: v1
data:
    api-key: &lt;PRIVATE_API_TOKEN&gt;<span class="o">=</span>
    region: <span class="nv">dXMtc291dGg</span><span class="o">=</span>
...
</code></pre></div>
</li>
</ol>
<h2 id="create-a-cloudant-service-using-the-crds">Create a Cloudant Service using the CRDs<a class="headerlink" href="#create-a-cloudant-service-using-the-crds" title="Permanent link">&para;</a></h2>
<ol>
<li>Once the Operator is installed, the Custom Resource Definitions to create the Cloudant service are also available. Navigate to your OpenShift dashboard, ensure you're in the <strong>Administrator</strong> view, navigate to your <strong>Installed Operators</strong> and click the IBM Cloud Operator:</li>
</ol>
<p><img alt="IBM Cloud Operator" src="../../assets/ibmcloudoperator.png" /></p>
<ol>
<li>You'll see that there's two APIs available -- a Service and a Binding. A <strong>Service</strong> will allow us to create the actual Cloudant service itself -- do that first by clicking <strong>Create Instance</strong> under <strong>Service</strong>. Copy and replace the following YAML:</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ibmcloud.ibm.com/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cloudant-service</span>
<span class="nt">spec</span><span class="p">:</span>
  <span class="nt">plan</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">lite</span>
  <span class="nt">serviceClass</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">cloudantnosqldb</span>
</code></pre></div>
<p><img alt="cloudantservice" src="../../assets/cloudantservice.png" /></p>
<p>Hit <strong>Create</strong>.</p>
<ol>
<li>Wait a couple minutes for the service to provision. You can check the status by clicking on your service, and looking for <strong>Message: Online</strong>:</li>
</ol>
<p>{% hint style='info' %} You can also debug any potential issues here. If you already have a Cloudant "Lite" service, you won't be able to create another. To work around this issue, edit the service yaml to use <code>standard</code> instead of <code>lite</code>. Note that "Standard Cloudant" is a paid service. Another option is to navigate to your IBM Cloud dashboard and delete your existing instance of the <code>lite</code> Cloudant. {% endhint %}</p>
<p><img alt="servicedone" src="../../assets/servicedone.png" /></p>
<ol>
<li>After verifying that there's no bugs and the service is "online", double-check that the Cloudant service exists in your account: <a href="https://cloud.ibm.com/resources">https://cloud.ibm.com/resources</a></li>
</ol>
<p>You may need to switch to your own account using the switcher on the top right.</p>
<p><img alt="resourcelist" src="../../assets/resourcelist.png" /></p>
<ol>
<li>Next, create the "binding" resource for your Operator <span class="arithmatex">\(instead of Service as you did above\)</span>:</li>
</ol>
<div class="highlight"><pre><span></span><code>apiVersion: ibmcloud.ibm.com/v1alpha1
kind: Binding
metadata:
  name: cloudant-binding
spec:
  serviceName: cloudant-service
</code></pre></div>
<p><img alt="bindingresource" src="../../assets/cloudantbinding.png" /></p>
<ol>
<li>The binding should get created fairly quickly -- you can check the status by clicking on your binding, and looking for <strong>Message: Online</strong>. By navigating to the <strong>Resources</strong> tab, you can see that the <strong>cloudant-binding</strong> secret is created. Click that to see your credentials for accessing your Cloudant DB, stored securely in a secret:</li>
</ol>
<p><img alt="binding secret" src="../../assets/bindingsecret.png" /></p>
<h2 id="deploy-the-nodejs-patient-database-app">Deploy the Node.js Patient Database App<a class="headerlink" href="#deploy-the-nodejs-patient-database-app" title="Permanent link">&para;</a></h2>
<p>Now you'll create the Node.js app that will populate your Cloudant DB with patient data. It will also serve data to the front-end application that we deployed in the first exercise.</p>
<ol>
<li>
<p>Make sure you're in the project <strong>example-health</strong>:</p>
<div class="highlight"><pre><span></span><code>oc project example-health
</code></pre></div>
</li>
<li>
<p>Run the following command to create this application:</p>
<div class="highlight"><pre><span></span><code>oc new-app --name<span class="o">=</span>patient-db centos/nodejs-10-centos7~https://github.com/svennam92/nodejs-patientdb-cloudant
</code></pre></div>
</li>
<li>
<p>The app will crash and fail to start repeatedly because the credentials to the Cloudant DB haven't been set yet.</p>
</li>
</ol>
<p><img alt="Crashing" src="../../assets/crashing.png" /></p>
<ol>
<li>Let's fix this by setting the environment variable to the <strong>cloudant-binding</strong> secret we created earlier. Navigate to the deployment config for the <code>patient-db</code> app by clicking the app, and then selecting the name next to <strong>DC</strong>:</li>
</ol>
<p><img alt="Deployment Config" src="../../assets/deploymentconfig.png" /></p>
<ol>
<li>Go to the <strong>Environment</strong> tab, click <strong>Add from Config Map or Secret</strong> and create a new environment variable named <strong>CLOUDANT_URL</strong>. Choose the <strong>cloudant-binding</strong> secret, then choose <strong>url</strong> for the Key. Hit the <strong>Save</strong> button.</li>
</ol>
<p><img alt="Environment from Secret" src="../../assets/envfromsecret.png" /></p>
<ol>
<li>Go back to the <strong>Topology</strong> tab, and the <strong>patient-db</strong> should successfully start shortly.</li>
</ol>
<p><img alt="Apps Running" src="../../assets/runningapps.png" /></p>
<h2 id="configure-front-end-patient-health-app-to-use-cloudant-database-backend">Configure Front-End Patient Health App to use Cloudant Database Backend<a class="headerlink" href="#configure-front-end-patient-health-app-to-use-cloudant-database-backend" title="Permanent link">&para;</a></h2>
<p>The <code>patient-ui</code> application has a configuration option for the backend database. To start using the database you configured above, follow the steps below to configure it.</p>
<ol>
<li>Access your <strong>patient-ui</strong> application again and click <strong>Settings</strong>.</li>
</ol>
<p>To find your routes, you can use the OpenShift console or type <code>oc get routes</code>.</p>
<p><img alt="clicksettings" src="../../assets/clicksettings.png" /></p>
<ol>
<li>Input the route <code>http://patient-db:8080/</code> and hit the <strong>node</strong> OpenShift icon.</li>
</ol>
<p>You won't need to expose this application with the <code>oc expose</code> command. This is because your frontend <code>patient-ui</code> application can talk to the backend <code>patient-db</code> without the network request leaving the cluster. Kubernetes keeps an internal DNS record of the services which resolve to the IPs of the running application.</p>
<p><img alt="inputurl" src="../../assets/inputurl.png" /></p>
<p>Your application is now backed by the mock patient data in the Cloudant DB! You can log-in using any user-id/password in the Cloudant DB, for example "<strong>opall:opall</strong>".</p>
<ol>
<li>In a real-world application, these passwords should <strong>not</strong> be stored as plain-text. To review the patients (and alternate logins) in the Cloudant DB, navigate to your services in IBM Cloud <a href="https://cloud.ibm.com/resources">Resource List</a>. Click <strong>cloudant-service</strong>.</li>
</ol>
<p><img alt="cloudantdb" src="../../assets/cloudantdb.png" /></p>
<ol>
<li>Launch the Cloudant dashboard and click the <code>patients</code> db.</li>
</ol>
<p><img alt="databases" src="../../assets/databases.png" /></p>
<ol>
<li>Click through the different patients you can log-in as.</li>
</ol>
<p><img alt="credentials" src="../../assets/credentials.png" /></p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../../pre-work/setup_cli/" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Configure Shell Access
              </div>
            </div>
          </a>
        
        
          <a href="../../exercise-02/readme/" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Configure the Sysdig Agent
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2020 IBM Developer
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/ibm" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/ibmdeveloper" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.linkedin.com/company/ibm/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://www.youtube.com/user/developerworks" target="_blank" rel="noopener" title="www.youtube.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://dev.to/ibmdeveloper" target="_blank" rel="noopener" title="dev.to" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M120.12 208.29c-3.88-2.9-7.77-4.35-11.65-4.35H91.03v104.47h17.45c3.88 0 7.77-1.45 11.65-4.35 3.88-2.9 5.82-7.25 5.82-13.06v-69.65c-.01-5.8-1.96-10.16-5.83-13.06zM404.1 32H43.9C19.7 32 .06 51.59 0 75.8v360.4C.06 460.41 19.7 480 43.9 480h360.2c24.21 0 43.84-19.59 43.9-43.8V75.8c-.06-24.21-19.7-43.8-43.9-43.8zM154.2 291.19c0 18.81-11.61 47.31-48.36 47.25h-46.4V172.98h47.38c35.44 0 47.36 28.46 47.37 47.28l.01 70.93zm100.68-88.66H201.6v38.42h32.57v29.57H201.6v38.41h53.29v29.57h-62.18c-11.16.29-20.44-8.53-20.72-19.69V193.7c-.27-11.15 8.56-20.41 19.71-20.69h63.19l-.01 29.52zm103.64 115.29c-13.2 30.75-36.85 24.63-47.44 0l-38.53-144.8h32.57l29.71 113.72 29.57-113.72h32.58l-38.46 144.8z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/vendor.0ac82a11.min.js"></script>
      <script src="../../assets/javascripts/bundle.f81dfb4d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script>
      
      <script>
        app = initialize({
          base: "../..",
          features: ['navigation.tabs'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.4ac00218.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>